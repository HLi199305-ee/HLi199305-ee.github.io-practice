<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Detailed Installation</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

   <!-- Markdown 切换暗主题 -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>
  <link id="hljs-theme" rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" defer></script>

  <style>
    :root{
      /* 等宽字体，与 index一致 */
      --font-mono: "JetBrains Mono","IBM Plex Mono","Source Code Pro",
                   "Cascadia Code",Consolas,Menlo,"Liberation Mono",
                   "DejaVu Sans Mono","Courier New",monospace;

      --brand-cpp-blue:#659BD3;
      --color-bg:#ffffff;
      --color-ink:#111;
      --color-card:#fff;
      --color-border:#e5e7eb;
      --ring:#1c7cc285;

      /* 选中时紫色 */
      --nav-active:#ab80d3;
    }
    html.theme-dark{
      --color-bg:#1a0b2e;
      --color-ink:#e5e5e5;
      --color-card:#1f2937;
      --color-border:#374151;
      /* 暗主题下仍用紫色 */
      --nav-active:#ab80d3;
    }

    body{
      margin:0; background:var(--color-bg); color:var(--color-ink);
      font:16px/1.7 system-ui, Segoe UI, Roboto, Arial, sans-serif;
      transition: background .25s ease, color .25s ease;
    }

    /* 顶部导航 */
    .navbar{ background: var(--brand-cpp-blue) !important; border-bottom:none; }
    .navbar.navbar-dark .navbar-brand, .navbar.navbar-dark .nav-link{ color:#fff !important; }
    .navbar .nav-link:hover,
    .navbar .nav-link:focus,
    .navbar .nav-link:focus-visible{
      color: var(--nav-active) !important;   /* --nav-active = #f5deb3 */
    }
    .navbar .nav-link:hover i,
    .navbar .nav-link:focus i,
    .navbar .nav-link:focus-visible i{
      color: var(--nav-active) !important;
    }
    .navbar-brand img{ height:48px; width:auto; display:block; }
    .navbar .nav-link,
    .navbar .nav-link i{ transition: color .15s ease; }
    .navbar .nav-link.active{ color: var(--nav-active) !important; }
    .navbar .nav-link.active i{ color: var(--nav-active) !important; }

    /* 左侧 Back*/
    .btn-back-nav{
      display:inline-flex; align-items:center; gap:.5rem;
      border:1px solid rgba(255,255,255,.6); color:#fff; background:transparent;
      padding:.35rem .7rem; border-radius:999px; text-decoration:none;
      transition: background .2s ease, transform .1s ease, box-shadow .2s ease;
      font-family: var(--font-mono); font-weight:700; letter-spacing:0;
      margin-left:.5rem;
    }
    .btn-back-nav i{ font-size:1.1rem; line-height:1; transition: color .15s ease; }
    .btn-back-nav:hover{
      background:rgba(255,255,255,.15);
      transform: translateY(-1px);
      box-shadow:0 6px 18px rgba(0,0,0,.18);
    }
    html.theme-dark .btn-back-nav{ border-color: rgba(255,255,255,.55); color:#fff; }

    /* 右侧切换按钮 */
    .header-tools{ display:flex; align-items:center; gap:.75rem; margin-left:.5rem; }
    .theme-switch{
      position:relative; width:44px; height:24px; background:#cbd5e1;
      border-radius:999px; cursor:pointer; transition:background .2s ease;
      border:1px solid rgba(255,255,255,.6);
    }
    .theme-switch::after{
      content:""; position:absolute; top:50%; left:3px; transform:translateY(-50%);
      width:18px; height:18px; border-radius:50%; background:#fff; transition:left .2s ease;
      box-shadow:0 1px 2px rgba(0,0,0,.15);
    }
    html.theme-dark .theme-switch{ background:#334155; border-color: var(--color-border); }
    html.theme-dark .theme-switch::after{ left:23px; }

    /* Markdown主内容 */
    .page{ max-width:920px; margin:2rem auto; padding:0 1rem 3rem; }
    .md{
      background:var(--color-card); border:1px solid var(--color-border);
      border-radius:14px; padding:1.25rem 1rem; box-shadow:0 6px 24px rgba(0,0,0,.06);
    }
    .md a{ color:#0969da; text-decoration:none; } .md a:hover{ text-decoration:underline; }
    .md code{ background:#f6f8fa; padding:.15em .35em; border-radius:4px; }
    .md pre{ background:#f6f8fa; padding:1rem; border-radius:12px; overflow:auto; border:1px solid var(--color-border); }

    /* 暗主题下调整底色 */
    html.theme-dark .md code{ background:#0b1220; color:#e5e7eb; }
    html.theme-dark .md pre{ background:#0b1220; border-color:#26324a; }

    /* Back 被选中调为紫色 */
    .btn-back-nav:hover,
    .btn-back-nav:focus,
    .btn-back-nav:focus-visible,
    .btn-back-nav:active,
    .btn-back-nav.active{
      color: var(--nav-active) !important; /* 文字米黄色 */
      border-color: #ab80d3 !important; /* 边框米黄色 */
    }

    /* 图标也变紫 */
    .btn-back-nav:hover i,
    .btn-back-nav:focus i,
    .btn-back-nav:focus-visible i,
    .btn-back-nav:active i,
    .btn-back-nav.active i{
      color: var(--nav-active) !important;
    }

  </style>
</head>
<body>
  <!-- 顶部导航：左侧C++Logo和Back图标；右侧 Home/GitHub/主题切换 -->
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
      <div class="d-flex align-items-center">
        <a class="navbar-brand d-flex align-items-center"
           href="https://isocpp.org/" target="_blank" rel="noopener">
          <img src="https://upload.wikimedia.org/wikipedia/commons/1/18/ISO_C%2B%2B_Logo.svg" alt="C++ Logo">
        </a>
        <a class="btn-back-nav" href="./getting-started.html" aria-label="Back to home">
          <i class="bi bi-arrow-left-circle-fill"></i>
          Back
        </a>
      </div>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <!-- 右侧：Home -->
          <li class="nav-item">
            <a class="nav-link" href="../index.html" data-match="index.html">
              <i class="bi bi-house-door-fill me-1"></i>Home
            </a>
          </li>
          <!-- 右侧：GitHub -->
          <li class="nav-item d-flex align-items-center ms-lg-3">
            <a class="nav-link p-1" href="https://github.com/your-repo-url" target="_blank" aria-label="GitHub">
              <i class="bi bi-github fs-4"></i>
            </a>
          </li>
        </ul>

        <!-- 右侧：主题切换 -->
        <div class="header-tools ms-3">
          <button id="themeToggle" class="theme-switch" title="Toggle light/dark" aria-label="Toggle theme"></button>
        </div>
      </div>
    </div>
  </nav>

  <!-- 主体：Markdown 内容 -->
  <div class="page">
    <div id="md-root" class="md">Loading Markdown…</div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- 主题切换 + 主题同步 + 点击为紫 -->
  <script>
    (function(){
      const root = document.documentElement;
      const KEY  = "harmony-theme";
      const btn  = document.getElementById("themeToggle");

      const HLJS_LIGHT = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css';
      const HLJS_DARK  = 'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css';
      function applyHljsTheme(isDark){
        const link = document.getElementById('hljs-theme');
        if (link) link.href = isDark ? HLJS_DARK : HLJS_LIGHT;
      }

      // 初始化主题
      const saved = localStorage.getItem(KEY);
      if (saved === "dark") root.classList.add("theme-dark");
      if (saved === "light") root.classList.remove("theme-dark");
      if (saved === null && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
        root.classList.add("theme-dark");
      }
      applyHljsTheme(root.classList.contains('theme-dark'));

      // 点击切换
      btn?.addEventListener("click", () => {
        root.classList.toggle("theme-dark");
        const isDark = root.classList.contains("theme-dark");
        localStorage.setItem(KEY, isDark ? "dark" : "light");
        applyHljsTheme(isDark);
      });

      // 点击为紫
      const current = (location.pathname.split('/').pop() || 'index.html').toLowerCase();
      document.querySelectorAll('.navbar .nav-link[data-match]').forEach(a=>{
        const list = a.getAttribute('data-match').split(',').map(s=>s.trim().toLowerCase());
        if (list.includes(current)) {
          a.classList.add('active');
          a.setAttribute('aria-current','page');
        }
      });
    })();
  </script>

  <!-- 渲染Markdown, 比如自动高亮代码块 -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const MD_PATH = './installation.md';  /* ← 这里与 getting-start.html 唯一不同：指向安装文档 */
      const hasHLJS = typeof window.hljs !== 'undefined';

      marked.setOptions({
        gfm: true, headerIds: true, mangle: false,
        highlight: (code, lang) => {
          if (hasHLJS) {
            try {
              if (lang && hljs.getLanguage(lang)) return hljs.highlight(code, { language: lang }).value;
              return hljs.highlightAuto(code).value;
            } catch(e){}
          }
          return code;
        }
      });

      fetch(MD_PATH, { cache: 'no-cache' })
        .then(r => { if(!r.ok) throw new Error('HTTP ' + r.status); return r.text(); })
        .then(txt => {
          document.getElementById('md-root').innerHTML = marked.parse(txt);
          if (hasHLJS) document.querySelectorAll('pre code').forEach(el => hljs.highlightElement(el));
        })
        .catch(err => {
          document.getElementById('md-root').innerHTML =
            `<p style="color:#b91c1c">Failed to load: ${err.message}</p>
            <p>Please make sure <code>${MD_PATH}</code> is in the same directory as this page and is accessed via http(s).</p>`;
          console.error('Markdown load error:', err);
        });
    });
  </script>
</body>
</html>

